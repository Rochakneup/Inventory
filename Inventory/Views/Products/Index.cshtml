@model IEnumerable<Inventory.Models.Product>

@{
    ViewData["Title"] = "Product List";
}

<h1>@ViewData["Title"]</h1>

<div class="container-box">
    <a asp-action="Create" class="btn btn-create">Add New Product</a>
    <button id="export-pdf" class="btn btn-danger">Export to PDF</button>
    <button id="export-excel" class="btn btn-success">Export to Excel</button>

    <div class="table-responsive">
        <table id="productTable" class="table">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Name</th>
                    <th>Description</th>
                    <th>Price</th>
                    <th>Supplier</th>
                    <th>Image</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var item in Model)
                {
                    <tr>
                        <td>@item.Id</td>
                        <td>@item.Name</td>
                        <td>@item.Description</td>
                        <td>@item.Price</td>
                        <td>@item.Supplier.Name</td>
                        <td><img src="@item.ImageUrl" alt="@item.Name" style="max-width: 100px; max-height: 100px;" /></td>
                        <td>
                            <a asp-action="Details" asp-route-id="@item.Id">Details</a> |
                            <a asp-action="Edit" asp-route-id="@item.Id">Edit</a> |
                            <a asp-action="Delete" asp-route-id="@item.Id">Delete</a>
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
</div>

<style>
    /* Your existing styles here */
</style>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.21/jspdf.plugin.autotable.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.4/xlsx.full.min.js"></script>
<script>
    document.getElementById('export-pdf').addEventListener('click', function () {
        const { jsPDF } = window.jspdf;
        const doc = new jsPDF();
        doc.text("Product List", 10, 10);

        doc.autoTable({
            html: '#productTable',
            startY: 20
        });

        doc.save('product_list.pdf');
    });

    document.getElementById('export-excel').addEventListener('click', function () {
        const wb = XLSX.utils.book_new();
        const ws = XLSX.utils.table_to_sheet(document.getElementById('productTable'));
        XLSX.utils.book_append_sheet(wb, ws, "Product List");
        XLSX.writeFile(wb, 'product_list.xlsx');
    });
</script>
